#textdomain wesnoth-dragonway

[scenario]
    name= _ "(#3) City in danger"
    map_data="{~add-ons/Way_of_Dragon/maps/03city}"
    victory_when_enemies_defeated=no
    id=03scen
    next_scenario=04scen

    [story]
        [part]
            story= _ "      "
	    background=data/add-ons/Way_of_Dragon/images/story/Logos/scen03logo.png
        [/part]
        [part]
            story= _ "While Torres fought in the cave with Dalvich, Virgil and Jeffrey haste to the city for help ..."
	    background=data/add-ons/Way_of_Dragon/images/story/GreatRiverEtinburgBridge.jpg
        [/part]
    [/story]

	{SECOND_WATCH}	
	{DAWN}
	{MORNING}
	{AFTERNOON}
	{DUSK}
	{FIRST_WATCH}


{TURNS 35 33 30}


	{SCENARIO_MUSIC "CityTheme.ogg"} 
	
 	{~add-ons/Way_of_Dragon/utils/blood_event.cfg}

	{STARTING_VILLAGES_AREA 1 2 3 1}


	# Описание сторон

    [side]
        side=1
        controller=human

        type=Bowman
        id=Virgil
        name= _ "Virgil"
        unrenamable=yes
        canrecruit=yes
	
	recruit=Fencer,Bowman,Thug,Footpad
        team_name=Humans
        user_team_name= _ "Humans"
        {GOLD 50 50 50}
	{INCOME -3 -3 -3}
    [/side]
    [side]
        side=2
        controller=ai
	
        type=General
        id=Freeman
        name= _ "Freeman"
        unrenamable=yes
        canrecruit=yes

        team_name=Guard
        user_team_name=_"Guards"
        {GOLD 25 30 35}
	{INCOME 2 3 4}
    [/side]
    [side]
        side=3
        controller=ai
        type=Iron Mauler
        id=Truman
        name= _ "Truman"
        unrenamable=yes

        canrecruit=yes
        team_name=Humans
        user_team_name=_"Humans"
        {GOLD 25 30 35}
	{INCOME 2 3 4}
    [/side]
    [side]
        side=4
        controller=ai
            type=Peasant
            id=Villager
        canrecruit=yes
        team_name=Humans
        user_team_name=_"Humans"
        {GOLD 25 30 35}
	{INCOME 2 3 4}
    [/side]




	# Эвент перед стартом

[event]
name=prestart
		[capture_village]
            		x=1,1,2,2,3,4,3,4,5,6,7,8,9,10,9,10,11,11,12
	   		y=5,6,5,6,6,6,7,4,5,5,2,2,3,3,1,1,1,2,2
			side=3
		[/capture_village]
		[capture_village]
            		x=19
	   		y=4
			side=4
		[/capture_village]	
					# Друг Виргила
	[unit]
            type=Fencer
            id=Jeffry
            name= _ "Jeffrey"
            unrenamable=yes
            side=1
            x=17
            y=20
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            {IS_LOYAL}
        [/unit]


					# Внешняя охрана
	[unit]
            type=Halberdier
            id=GuardOutside1
            side=3
            x=15
            y=11
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Halberdier
            id=GuardOutside2
            side=3
            x=18
            y=11
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]


					# Вход в город
	[unit]
            type=Halberdier
            id=GuardEntrace1
	    name= _ "Gan"
            unrenamable=yes
            side=3
            x=9
            y=6
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Halberdier
            id=GuardEntrace2
	    name=_ "Don"
            unrenamable=yes
            side=3
            x=10
            y=5
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]

					# город охрана

	[unit]
            type=Halberdier
            id=GuardCity1
            side=3
            x=3
            y=1
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Master Bowman
            id=GuardCity2
            side=3
            x=14
            y=3
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Halberdier
            id=GuardCity3
            side=2
            x=1
            y=2
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Master Bowman
            id=GuardCity4
            side=3
            x=3
            y=9
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]





	[unit]
            type=Royal Guard
            id=GuardCityIn1
            side=3
            x=6
            y=4
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Royal Guard
            id=GuardCityIn2
            side=3
            x=7
            y=5
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Royal Guard
            id=GuardCityIn3
            side=3
            x=8
            y=3
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Royal Guard
            id=GuardCityIn4
            side=3
            x=9
            y=4
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Halberdier
            id=GuardCityIn5
            side=3
            x=7
            y=3
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Halberdier
            id=GuardCityIn6
            side=3
            x=5
            y=4
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]


                {VARIABLE farriersale 0}
                {VARIABLE nauomnik 0}
                {VARIABLE badnaemnik 0}
                {VARIABLE goodnaemnik 0}
                {VARIABLE badnaemniknexttime 0}
                {VARIABLE dopbandits 0}
                {VARIABLE endmission 0}
                {VARIABLE naim 0}
                {VARIABLE buy 0}
                {VARIABLE powersword 0}
                {VARIABLE powerbow 0}
                {VARIABLE koster 0}

[/event]





	# Эвент на первом ходу

[event]
	name=start

	[message]
            id=Jeffry
            message= _ "Good that city is not far from cavern."
	[/message]
	[message]
            id=Virgil
            message= _ "We must hurry to get back and save Torres!"
	[/message]
        [objectives]
            [objective]
                description= _ "Report about danger in cavern to head of the city guards"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Virgil"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Jeffrey"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
		show_turn_counter=yes
            [/objective]
        [/objectives]


		# Название города

        [item]
            x,y=12,5
            image=scenery/signpost.png
        [/item]
	[label]
	    x,y=12,5
	    text= _ "City Etinburg"
	    colour=0,0,175
	    visible_in_shroud=yes
	[/label]
	[label]
	    x,y=1,1
	    text= _ "Head of the city guards"
	    colour=175,0,0
	    visible_in_shroud=yes
	[/label]
     		   [scroll_to]
         	   	x=1
       		  	y=1
     		   [/scroll_to]
			[delay]
			    time=700
			[/delay]
     		   [scroll_to]
         	   	x=19
       		  	y=20
     		   [/scroll_to]
[/event]


	# Эвент "Засада на подходе к городу"

[event]
        name=moveto
        [filter]
	    side=1
	    x=13,12,12,13,12,13,12,13,12,13,14,14,15
	    y=16,16,17,17,15,15,14,14,13,13,13,12,13
        [/filter]

	[unit]
            type=Rogue
            id=Bandit1
            side=2
            x=13
            y=18
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Bandit
            id=Bandit2
            side=2
            x=13
            y=16
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Outlaw
            id=Bandit3
            side=2
            x=12
            y=17
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Ruffian
            name= _ "Kryun helper"
            unrenamable=yes
            id=Bandit4
            side=2
            x=12
            y=15
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[message]
            id=Bandit1
            message= _ "Whoa! Stop!"
	[/message]
        [sound]
            name=data/add-ons/Way_of_Dragon/Music/sounds/zasada.ogg
        [/sound]
			[delay]
			    time=300
			[/delay]

	[message]
            id=Virgil
            message= _ "It's an ambush!"
	[/message]
	[message]
            id=Jeffry
            message= _ "Real?"
	[/message]
	[message]
            id=Virgil
            message= _ "Unfortunately, yes!"
	[/message]
	[message]
            id=Bandit3
            message= _ "Shut up!"
	[/message]
	[message]
        speaker=Bandit2
	message= _ "Choose - money or your life?"
        [option]
		message= _ "Take a money! I am a coward!"
            [command]
                {VARIABLE zasada 1}
            [/command]
        [/option]

        [option]
		message= _ "Without fighting you will get nothing! Pray for mercy!"
            [command]
                {VARIABLE zasada 0}
            [/command]
        [/option]
	[/message]

	{IF_VAR zasada equals 1 (
                [then]
                	[gold]
                   	 side=1
                   	 amount=-50
                	[/gold]
        [chat]
            speaker=Money
            message= _ "Spent 50 gold."
        [/chat]
	[message]
            id=Bandit1
            message= _ "Here so that! Let's go away, guys!"
	[/message]
	[message]
       		speaker=Bandit2
		message= _ "See you later, fools!"
	[/message]
                [terrain]
                    x=11
                    y=16
                    terrain=Re
                [/terrain]
                [redraw]
                [/redraw]
	{MOVE_UNIT id=Bandit1 11 16}
	[kill]
            id=Bandit1
            x=11
            y=16
	[/kill]
	{MOVE_UNIT id=Bandit2 11 16}
	[kill]
            id=Bandit2
            x=11
            y=16
	[/kill]
	{MOVE_UNIT id=Bandit3 11 16}
	[kill]
            id=Bandit3
            x=11
            y=16
	[/kill]


	[message]
       		speaker=Bandit4
		message= _ "I hate cowards!"
	[/message]
	{MOVE_UNIT id=Bandit4 11 16}
	[kill]
            id=Bandit4
            x=11
            y=16
	[/kill]
                [terrain]
                    x=11
                    y=16
                    terrain=Re^Xo
                [/terrain]
                [redraw]
                [/redraw]
                {VARIABLE dopbandits 1}
                [/then]
            )} 


	{IF_VAR zasada equals 0 (
                [then]
	[message]
        	speaker=Bandit4
		message= _ "It's time to have some fun!"
	[/message]
			[delay]
			    time=500
			[/delay]
		[music]
   			name=data/add-ons/Way_of_Dragon/music/solo_fight_theme.ogg
		[/music]

	[message]
        	speaker=GuardOutside1
		message= _ "Guards! Here an armed attack!"
	[/message]
	{MOVE_UNIT id=GuardOutside1 12 13}
	{MOVE_UNIT id=GuardOutside2 13 14}
                [terrain]
                    x=15
                    y=11
                    terrain=Ch^Xo
                [/terrain]
                [terrain]
                    x=18
                    y=11
                    terrain=Ch^Xo
                [/terrain]
                [redraw]
                [/redraw]
                {VARIABLE dopbandits 0}

                [/then]
            )} 
[/event]


	# Если убит стражник...
[event]
        name=die
        [filter]
            id=GuardOutside1
        [/filter]
        [message]
            id=GuardOutside1
            message= _ "Guaaaaards..."
        [/message]
	[unit]
            type=Cavalier
            id=GuardOutside12
            side=3
            x=8
            y=5
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	{MOVE_UNIT id=GuardOutside12 16 11}
[/event]
[event]
        name=die
        [filter]
            id=GuardOutside2
        [/filter]
        [message]
            id=GuardOutside2
            message= _ "Guaaaaards..."
        [/message]
	[unit]
            type=Cavalier
            id=GuardOutside22
            side=3
            x=9
            y=5
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	{MOVE_UNIT id=GuardOutside22 17 12}
[/event]


									# Music changes when dead bandits
[event]
        name=die
        [filter]
            id=Bandit1
            id=Bandit2
            id=Bandit3
            id=Bandit4
        [/filter]

		[music]
   			name=data/add-ons/Way_of_Dragon/music/CityTheme.ogg
		[/music]
[/event]

	# Эвент на входе в город

[event]
        name=moveto
        [filter]
	    id=Virgil
	    x=10,11
	    y=6,6
        [/filter]

		[music]
   			name=data/add-ons/Way_of_Dragon/music/CityTheme.ogg
		[/music]


  [message]
            id=Jeffry
            message= _ "Sorry friend, but I think Torres will not survive long! Go on without me, and I will back in cavern and try to save him!"
	[/message]
        [message]
            id=Virgil
            message= _ "Wait, wait!"
	[/message]
                [terrain]
                    x=16
                    y=20
                    terrain=Rb
                [/terrain]
                [redraw]
                [/redraw]
			[delay]
			    time=500
			[/delay]
	{MOVE_UNIT id=Jeffry 16 20}
	[kill]
            id=Jeffry
            x=16
            y=20
	[/kill]
                [terrain]
                    x=16
                    y=20
                    terrain=Rb^Xo
                [/terrain]
                [redraw]
                [/redraw]

                [terrain]
                    x=15
                    y=11
                    terrain=Ch
                [/terrain]
                [terrain]
                    x=18
                    y=11
                    terrain=Ch
                [/terrain]
                [redraw]
                [/redraw]


	{IF_VAR zasada equals 0 (
                [then]
      {MOVE_UNIT id=GuardOutside1 15 11}
      {MOVE_UNIT id=GuardOutside2 18 11}
      {MOVE_UNIT id=GuardOutside12 15 11}
      {MOVE_UNIT id=GuardOutside22 18 11}
                [/then]
            )} 

			[delay]
			    time=500
			[/delay]

        [objectives]
            [objective]
                description= _ "Report about danger in cavern to head of the city guards"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Virgil"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
		show_turn_counter=yes
            [/objective]
        [/objectives]


	[message]
            id=GuardEntrace1
            message= _ "Hold on, outsider!"
        [option]
		message= _ "Outsider? But I have my own house in city!"
            [command]
                {VARIABLE enter 1}
            [/command]
        [/option]
        [option]
		message= _ "Okay, now what? ..."
            [command]
                {VARIABLE enter 1}
            [/command]
        [/option]
        [option]
		message= _ "Maybe we will solve all quickly? (give 30 gold)"
            [command]
                {VARIABLE enter 101}
            [/command]
        [/option]
        [option]
		message= _ "Out of my way, or or regret about this!"
            [command]
                {VARIABLE enter 3}
            [/command]
        [/option]
	[/message]

 						# Вариант продолжение диалога (1)

	{IF_VAR enter equals 1 (
                [then]
	[message]
        	id=GuardEntrace1
		message= _ "Who are you?!"
        	[option]
			message= _ "My name is too famous to call it."
          	  [command]
          	  [set_variable]
          	      name=enter
		      value=20
        	  [/set_variable]
        	  [/command]
       		[/option]
     		[option]
			message= _ "Maybe we will solve all quickly? (give 30 gold)"
          	  [command]
          	  [set_variable]
          	      name=enter
		      value=101
        	  [/set_variable]
          	  [/command]
      		[/option]
      		[option]
			message= _ "I'm Virgil. House - the second left near waterfront."
          	  [command]
          	  [set_variable]
          	      name=enter
		      value=100
        	  [/set_variable]
         	  [/command]
      		[/option]
	[/message]
                [/then]
            )} 




 						# Вариант продолжение диалога (20)

	{IF_VAR enter equals 20 (
                [then]
	[message]
        	id=GuardEntrace1
		message= _ "Then get out away, while you safe!"
        [option]
		message= _ "Joke, joke! Now I'm will answer seriously."
            [command]
          	  [set_variable]
          	      name=enter
		      value=123
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "Prepare to fight!"
            [command]
          	  [set_variable]
          	      name=enter
		      value=3
        	  [/set_variable]
            [/command]
        [/option]
	[/message]
                [/then]
            )} 

  						# Вариант драка (3)
	{IF_VAR enter equals 3 (
                [then]
	[message]
        	id=GuardEntrace1
		message= _ "You're daring! Now I'll teach you!"
	[/message]
			[delay]
			    time=500
			[/delay]

		[music]
   			name=data/add-ons/Way_of_Dragon/music/solo_fight_theme.ogg
		[/music]

	[message]
        	speaker=GuardEntrace1
		message= _ "Guards! Here an armed attack!"
	[/message]


	{MODIFY_UNIT id=GuardEntrace1 side 2}
	{MODIFY_UNIT id=GuardEntrace2 side 2}
	{MODIFY_UNIT id=GuardOutside1 side 2}
	{MODIFY_UNIT id=GuardOutside2 side 2}
	{MODIFY_UNIT id=GuardOutside12 side 2}
	{MODIFY_UNIT id=GuardOutside22 side 2}

	{MODIFY_UNIT id=GuardCityIn1 side 2}
	{MODIFY_UNIT id=GuardCityIn2 side 2}
	{MODIFY_UNIT id=GuardCityIn3 side 2}
	{MODIFY_UNIT id=GuardCityIn4 side 2}
	{MODIFY_UNIT id=GuardCityIn5 side 2}
	{MODIFY_UNIT id=GuardCityIn6 side 2}
 
                [/then]
            )} 


 						# Вариант продолжение диалога (123)

	{IF_VAR enter equals 123 (
                [then]
	[message]
        	id=GuardEntrace1
		message= _ "Correctly thinking! Now call yourself!"
        [option]
		message= _ "Maybe we will solve all quickly? (give 30 gold)"
            [command]
          	  [set_variable]
          	      name=enter
		      value=101
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "I'm Virgil. House - the second left near waterfront."
            [command]
          	  [set_variable]
          	      name=enter
		      value=100
        	  [/set_variable]
            [/command]
        [/option]
	[/message]
                [/then]
            )} 


						# Вариант Успешный вход (nonfree) (101)

	{IF_VAR enter equals 101 (
                [then]
                	[gold]
                   	 side=1
                   	 amount=-30
                	[/gold]
        [chat]
            speaker=Money
            message= _ "Spent 30 gold."
        [/chat]
			[delay]
			    time=500
			[/delay]
	[message]
        	id=GuardEntrace1
		message= _ "Looks like everything is all right. Welcome to city, citizen!"
	[/message]
                [terrain]
                    x=8
                    y=6
                    terrain=Ch
                [/terrain]
                [terrain]
                    x=11
                    y=5
                    terrain=Ch
                [/terrain]
                [redraw]
                [/redraw]

                [terrain]
                    x=8
                    y=5
                    terrain=Rrc
                [/terrain]
                [terrain]
                    x=9
                    y=5
                    terrain=Rrc
                [/terrain]
                [terrain]
                    x=10
                    y=4
                    terrain=Rrc
                [/terrain]
                [redraw]
                [/redraw]
	[message]
        	id=Virgil
		message= _ "Thank you!"
	[/message]

      {MOVE_UNIT id=GuardEntrace1 8 6}
      {MOVE_UNIT id=GuardEntrace2 11 5}

	[unit]
            type=Ranger
            id=Naemnik1
            side=4
            x=13
            y=1
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
                [/then]
            )} 

						# Вариант Успешный вход (free) (100)
	{IF_VAR enter equals 100 (
                [then]
			[delay]
			    time=500
			[/delay]
	[message]
        	id=GuardEntrace1
		message= _ "Looks like everything is all right. Welcome to city, citizen!"
	[/message]
                [terrain]
                    x=8
                    y=6
                    terrain=Ch
                [/terrain]
                [terrain]
                    x=11
                    y=5
                    terrain=Ch
                [/terrain]
                [redraw]
                [/redraw]

                [terrain]
                    x=8
                    y=5
                    terrain=Rrc
                [/terrain]
                [terrain]
                    x=9
                    y=5
                    terrain=Rrc
                [/terrain]
                [terrain]
                    x=10
                    y=4
                    terrain=Rrc
                [/terrain]
                [redraw]
                [/redraw]
	[message]
        	id=Virgil
		message= _ "Thank you!"
	[/message]

      {MOVE_UNIT id=GuardEntrace1 8 6}
      {MOVE_UNIT id=GuardEntrace2 11 5}

	[unit]
            type=Assassin
            id=Naemnik2
            side=4
            x=13
            y=1
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]

                [/then]
            )} 
[/event]





					# Эвент бонус дома
[event]
        name=moveto
        [filter]
            x,y=3,4
            id=Virgil
        [/filter]
	[message]
            id=Virgil
            message= _ "Home, sweet home!"
	[/message]
                	[gold]
                   	 side=1
                   	 amount=25
                	[/gold]
			{FULL_HEAL id=Virgil}
        [chat]
            speaker= _ "Money"
            message= _ "Received 25 gold."
        [/chat]
        [chat]
            speaker= _ "Player Health"
            message= _ "Character completely cured!"
        [/chat]
  

[/event]


	# Эвент появления кузнеца
[event]
        name=turn 3
	[unit]
            type=Thug
            id=Farrier
            side=4
            x=19
            y=4
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb
                [/terrain]
                [redraw]
                [/redraw]
	[unit]
            type=Peasant
            id=Villager2
            side=4
            x=19
            y=8
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Peasant
            id=Villager2
            side=4
            x=16
            y=15
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
[/event]
[event]
        name=turn 6
	[kill]
            id=Farrier
            x=19
            y=4
	[/kill]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb^Xo
                [/terrain]
                [redraw]
                [/redraw]
[/event]


	# Эвент на 7 ходу

[event]
        name=turn 10
      	[unit]
            type=Pirate Galleon
            id=Ship
            side=2
            x=6
            y=18
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
      {MOVE_UNIT id=Ship 1 17}
	[kill]
            id=Ship
            x=1
            y=17
	[/kill]
[/event]
					# Джефри живой (уходит)
[event]
	name=moveto
        [filter]
            x,y=16,20
            id=Jeffry
        [/filter]
      {VARIABLE jeffry 1}
[/event]



	# Эвент на 8 ходу

[event]
	name=turn 8

[/event]


					# Эвент Разговор 2й блокпост

[event]
        name=moveto
        [filter]
	    side=1
	    x=3,4
	    y=3,2
        [/filter]
	[message]
            id=Truman
            message= _ "Stop! Entrance only for the guards!"
        [option]
		message= _ "But why?"
            [command]
          	  [set_variable]
          	      name=enterend
		      value=1
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "Maybe let me in? (give 45 gold)"
            [command]
          	  [set_variable]
          	      name=enterend
		      value=2
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "Get away out of the way!"
            [command]
          	  [set_variable]
          	      name=enterend
		      value=3
        	  [/set_variable]
            [/command]
        [/option]
	[/message]


  						# Вариант продолжение диалога (1)
	{IF_VAR enterend equals 1 (
                [then]
	[message]
        	id=Truman
		message= _ "Sorry, citizen. But I repeat - entrance only for guards, because there's too high level of crime in the city."
        [option]
		message= _ "What can I do to let me in?"
            [command]
          	  [set_variable]
          	      name=enterend
		      value=101
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "But I really need to transmit an important message personally to head of the city guards!"
            [command]
          	  [set_variable]
          	      name=enterend
		      value=101
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "Crime? Really? No, I never heard about it."
            [command]
          	  [set_variable]
          	      name=enterend
		      value=102
        	  [/set_variable]
            [/command]
        [/option]
	[/message]
                [/then]
            )} 




  						# Вариант неудачный подкуп (2)
	{IF_VAR enterend equals 2 (
                [then]
	[message]
        	id=Truman
		message= _ "Did you know that by law, I have the right to put you in jail for a bribe?"
        [option]
		message= _ "Come on! Try it! I'm sooo scared!"
            [command]
          	  [set_variable]
          	      name=enterend
		      value=200
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "Maybe there is something that I can do for you, and we forget about that misunderstanding?"
            [command]
          	  [set_variable]
          	      name=enterend
		      value=101
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "Just touch me! Or you will regret about it!"
            [command]
          	  [set_variable]
          	      name=enterend
		      value=3
        	  [/set_variable]
            [/command]
        [/option]
	[/message]
                [/then]
            )} 




  						# Вариант гг тупит и юморит (102)
	{IF_VAR enterend equals 102 (
                [then]
	[message]
        	id=Truman
		message= _ "Are you joker? Get out!"
        [option]
		message= _ "What can I do to let me in?"
            [command]
          	  [set_variable]
          	      name=enterend
		      value=101
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "You have a problems with sense of humor? Stupid tin can!"
            [command]
          	  [set_variable]
          	      name=enterend
		      value=3
        	  [/set_variable]
            [/command]
        [/option]
	[/message]
                [/then]
            )} 



  						# Вариант диалог про уничтожение воров (101)
	{IF_VAR enterend equals 101 (
                [then]
	[message]
        	id=Truman
		message= _ "You're pushy! All right. If you find and kill bandits, who attacked peoples near the city, you'll be able to enter."
        [option]
		message= _ "I kill that bandits. But I need some help ..."
            [command]
          	  [set_variable]
          	      name=enterend
		      value=1001
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "No way man! I haven't time for this!"
            [command]
          	  [set_variable]
          	      name=enterend
		      value=201
        	  [/set_variable]
            [/command]
        [/option]
	[/message]
                [/then]
            )} 



  						# Вариант драка (3)
	{IF_VAR enterend equals 3 (
                [then]
	[message]
        	id=Truman
		message= _ "You have a long tongue! Now, I will correct it!"
	[/message]
			[delay]
			    time=500
			[/delay]

		[music]
   			name=data/add-ons/Way_of_Dragon/music/solo_fight_theme.ogg
		[/music]

	[message]
        	id=Truman
		message= _ "Guards! Here an armed attack!"
	[/message]

	{MODIFY_UNIT id=Truman side 2}
	{MODIFY_UNIT id=GuardCity1 side 2}
	{MODIFY_UNIT id=GuardCity2 side 2}
	{MODIFY_UNIT id=GuardCity4 side 2}
	{MODIFY_UNIT id=GuardEntrace1 side 2}
	{MODIFY_UNIT id=GuardEntrace2 side 2}
	{MODIFY_UNIT id=GuardOutside1 side 2}
	{MODIFY_UNIT id=GuardOutside2 side 2}
	{MODIFY_UNIT id=GuardOutside12 side 2}
	{MODIFY_UNIT id=GuardOutside22 side 2}

	{MODIFY_UNIT id=GuardCityIn1 side 2}
	{MODIFY_UNIT id=GuardCityIn2 side 2}
	{MODIFY_UNIT id=GuardCityIn3 side 2}
	{MODIFY_UNIT id=GuardCityIn4 side 2}
	{MODIFY_UNIT id=GuardCityIn5 side 2}
	{MODIFY_UNIT id=GuardCityIn6 side 2}

                [/then]
            )} 

  						# Вариант тюрьма (200)
	{IF_VAR enterend equals 200 (
                [then]
	[message]
        	id=Truman
		message= _ "You must think about it offense for a long time!"
	[/message]
        [message]
            speaker=narrator
            message= _ "You did not had to inform about danger, and soon the city was attacked by undead. The siege lasted not long, and soon in the city there is not a living soul ..."
            image=items/cage.png
        [/message]
        [message]
            speaker=narrator
            message= _ "Quest failed!"
            image=wesnoth-icon.png
	[/message]
        [endlevel]
            result=defeat
        [/endlevel]
                [/then]
            )} 

  						# Вариант отказ от квеста с ворами (201)
	{IF_VAR enterend equals 201 (
                [then]
	[message]
        	id=Truman
		message= _ "Well, you can go. But I am will not let you to enter!"
	[/message]
        [message]
            speaker=narrator
            message= _ "You did not had to inform about danger, and soon the city was attacked by undead. The siege lasted not long, and soon in the city there is not a living soul ..."
            image=items/bones.png
        [/message]
        [message]
            speaker=narrator
            message= _ "Quest failed!"
            image=wesnoth-icon.png
	[/message]
        [endlevel]
            result=defeat
        [/endlevel]
                [/then]
            )} 

  						# Вариант диалог про помощь в убиении воров (1001)
	{IF_VAR enterend equals 1001 (
                [then]
	[message]
        	id=Truman
		message= _ "Well ... You can take a two my soldiers. Or I'll give you some money - enough to hire a mercenary in the city and buy some equipment from smith."
        [option]
		message= _ "Give me your soldiers."
            [command]
          	  [set_variable]
          	      name=enterend
		      value=2001
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "Give me some money."
            [command]
          	  [set_variable]
          	      name=enterend
		      value=2002
        	  [/set_variable]
            [/command]
        [/option]
	[/message]

                [/then]
            )} 


  						# Вариант диалог про помощь - дано 2 солдата (2001)
	{IF_VAR enterend equals 2001 (
                [then]
	[unit]
            type=Pikeman
            id=SoldierHelp1
            side=1
            x=4
            y=3
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            {IS_LOYAL}
        [/unit]
	[unit]
            type=Lieutenant
            id=SoldierHelp2
            side=1
            x=6
            y=2
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            {IS_LOYAL}
        [/unit]
                [terrain]
                    x=10
                    y=7
                    terrain=Re
                [/terrain]
                [terrain]
                    x=17
                    y=7
                    terrain=Rb
                [/terrain]

                [terrain]
                    x=13
                    y=2
                    terrain=Rrc
                [/terrain]
                [terrain]
                    x=12
                    y=1
                    terrain=Rrc
                [/terrain]
                [redraw]
                [/redraw]
                [/then]
            )} 
	{IF_VAR enterend equals 2001 (
                [then]
	[message]
        	id=Truman
		message= _ "That it's the best fighters that I can give to you for now."
	[/message]
	[message]
        	speaker=SoldierHelp1
		message= _ "We will not fail, sir!"
	[/message]
	[message]
        	speaker=SoldierHelp2
		message= _ "What are your orders?"
	[/message]
	[message]
        	speaker=Virgil
		message= _ "You may think that the problem with bandits has been solved!"
	[/message]

     		   [scroll_to]
         	   	x=5
       		  	y=10
     		   [/scroll_to]
       [objectives]
            [objective]
                description= _ "Destroy bandits in the forest outside the city"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Virgil"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
		show_turn_counter=yes
            [/objective]
        [/objectives]

        {HIGHLIGHT_IMAGE 5 10 items/gohere.png ()}

                 [/then]
            )} 

  						# Вариант диалог про помощь - дано 50 золота (2002)
	{IF_VAR enterend equals 2002 (
                [then]
	[message]
        	id=Truman
		message= _ "Here 50 gold. Mercenary will cost you 40. Any equipment, probably in 10-20 gold."
	[/message]
                	[gold]
                   	 side=1
                   	 amount=50
                	[/gold]
        [chat]
            speaker= _ "Money"
            message= _ "Received 50 gold."
        [/chat]
	[message]
        	speaker=Virgil
		message= _ "You may think that the problem with bandits has been solved!"
	[/message]
                [terrain]
                    x=10
                    y=7
                    terrain=Re
                [/terrain]
                [terrain]
                    x=17
                    y=7
                    terrain=Rb
                [/terrain]

                [terrain]
                    x=13
                    y=2
                    terrain=Rrc
                [/terrain]
                [terrain]
                    x=12
                    y=1
                    terrain=Rrc
                [/terrain]
                [redraw]
                [/redraw]

     		   [scroll_to]
         	   	x=13
       		  	y=1
     		   [/scroll_to]
			[delay]
			    time=600
			[/delay]
	[label]
	    x,y=13,1
	    text= _ "Mercenary"
	    colour=175,0,0
	    visible_in_shroud=yes
	[/label]
			[delay]
			    time=600
			[/delay]
     		   [scroll_to]
         	   	x=19
       		  	y=4
     		   [/scroll_to]
	[label]
	    x,y=19,4
	    text= _ "Smith (works only during the day!)"
	    colour=175,0,0
	    visible_in_shroud=yes
	[/label]
			[delay]
			    time=600
			[/delay]
     		   [scroll_to]
         	   	x=1
       		  	y=1
     		   [/scroll_to]


        [objectives]
            [objective]
                description= _ "Destroy bandits in the forest outside the city"
                condition=win
            [/objective]
            [objective]
                {ALTERNATIVE_OBJECTIVE_CAPTION}
                description= _ "Hire a Mercenary and buy any equipment from smith"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Virgil"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
		show_turn_counter=yes
            [/objective]
        [/objectives]


                {VARIABLE farriersale 1}
                {VARIABLE nauomnik 1}
                {VARIABLE buy 1}

     		   [scroll_to]
         	   	x=5
       		  	y=10
     		   [/scroll_to]

        {HIGHLIGHT_IMAGE 5 10 items/gohere.png ()}

                [/then]
            )} 

[/event]



	# Эвент появления кузнеца
[event]
        name=turn 9
	[unit]
            type=Thug
            id=Farrier
            side=4
            x=19
            y=4
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb
                [/terrain]
                [redraw]
                [/redraw]
[/event]
[event]
        name=turn 12
	[kill]
            id=Farrier
            x=19
            y=4
	[/kill]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb^Xo
                [/terrain]
                [redraw]
                [/redraw]
[/event]
[event]
        name=turn 15
	[unit]
            type=Thug
            id=Farrier
            side=4
            x=19
            y=4
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb
                [/terrain]
                [redraw]
                [/redraw]
[/event]
[event]
        name=turn 18
	[kill]
            id=Farrier
            x=19
            y=4
	[/kill]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb^Xo
                [/terrain]
                [redraw]
                [/redraw]
[/event]
[event]
        name=turn 21
	[unit]
            type=Thug
            id=Farrier
            side=4
            x=19
            y=4
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb
                [/terrain]
                [redraw]
                [/redraw]
[/event]
[event]
        name=turn 24
	[kill]
            id=Farrier
            x=19
            y=4
	[/kill]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb^Xo
                [/terrain]
                [redraw]
                [/redraw]
[/event]
[event]
        name=turn 27
	[unit]
            type=Thug
            id=Farrier
            side=4
            x=19
            y=4
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb
                [/terrain]
                [redraw]
                [/redraw]
[/event]
[event]
        name=turn 30
	[kill]
            id=Farrier
            x=19
            y=4
	[/kill]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb^Xo
                [/terrain]
                [redraw]
                [/redraw]
[/event]
[event]
        name=turn 33
	[unit]
            type=Thug
            id=Farrier
            side=4
            x=19
            y=4
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb
                [/terrain]
                [redraw]
                [/redraw]
[/event]
[event]
        name=turn 36
	[kill]
            id=Farrier
            x=19
            y=4
	[/kill]
                [terrain]
          	    x=18
           	    y=4
                    terrain=Rb^Xo
                [/terrain]
                [redraw]
                [/redraw]
[/event]


					# Эвент покупки у кузнеца

[event]
        name=moveto
        first_time_only=no
        [filter]
            x,y=18,4
            id=Virgil
        [/filter]



					# Кузнец торгует

	{IF_VAR farriersale equals 1 (
                [then]               
	{IF_VAR buy equals 1 (
                [then]   
        [message]
            speaker=Virgil
            message= _ "Hello, smith. I need to buy some useful things in your shop."
	[/message]
        [message]
            speaker=Farrier
            message= _ "I knew you'd come. So, what do you want to buy?"
        [option]
		message= _ "Sword (temporary +3 damage with sword) - 10 gold"
            [command]
          	  [set_variable]
          	      name=power
		      value=101
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "Armor (temporary increase to health +20) - 15 gold"
            [command]
          	  [set_variable]
          	      name=power
		      value=102
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "New bow (temporary +3 damage with bow) - 20 gold"
            [command]
          	  [set_variable]
          	      name=power
		      value=103
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "I do not need anything."
            [command]
          	  [set_variable]
          	      name=power
		      value=200
        	  [/set_variable]
            [/command]
        [/option]
        [/message]
                [/then]
            )} 


					# Кузнец - покупка меча (101)

	{IF_VAR power equals 101 (
                [then]     
		[modify_unit]
			[filter]
				id=Virgil
			[/filter]
    [attack]
        name=short sword
        description=_"short sword"
        icon=attacks/sword-human-short.png
        type=blade
        range=melee
        damage=7
        number=2
    [/attack]
    [attack]
        name=bow
        description=_"bow"
        type=pierce
        range=ranged
        damage=6
        number=3
    [/attack]
		[/modify_unit]

        [message]
            speaker=Virgil
            message= _ "Well, here's the money."
	[/message]
                	[gold]
                   	 side=1
                   	 amount=-10
                	[/gold]
        [chat]
            speaker= _ "Money"
            message= _ "Spent 10 gold."
        [/chat]
        [message]
            speaker=Farrier
            message= _ "With you pleased to deal."
        [/message]
                {VARIABLE power 201}
                {VARIABLE buy 0}
                {VARIABLE powersword 1}
	[label]
	    x,y=19,4
	    text= _ ""
	    colour=175,0,0
	    visible_in_shroud=yes
	[/label]
                [/then]
            )} 


					# Кузнец - покупка брони (102)

	{IF_VAR power equals 102 (
                [then]     
		{FULL_HEAL id=Virgil}
		[modify_unit]
			[filter]
				id=Virgil
			[/filter]
		hitpoints=+20
		[/modify_unit]

        [message]
            speaker=Virgil
            message= _ "Well, here's the money."
	[/message]
                	[gold]
                   	 side=1
                   	 amount=-15
                	[/gold]
        [chat]
            speaker= _ "Money"
            message= _ "Spent 15 gold."
        [/chat]   
        [message]
            speaker=Farrier
            message= _ "With you pleased to deal."
        [/message]
                {VARIABLE power 201}
                {VARIABLE buy 0}
	[label]
	    x,y=19,4
	    text= _ ""
	    colour=175,0,0
	    visible_in_shroud=yes
	[/label]
                [/then]
            )} 


					# Кузнец - покупка лука (103)

	{IF_VAR power equals 103 (
                [then]     
		[modify_unit]
			[filter]
				id=Virgil
			[/filter]
    [attack]
        name=short sword
        description=_"short sword"
        icon=attacks/sword-human-short.png
        type=blade
        range=melee
        damage=4
        number=2
    [/attack]
    [attack]
        name=bow
        description=_"bow"
        type=pierce
        range=ranged
        damage=9
        number=3
    [/attack]
		[/modify_unit]

        [message]
            speaker=Virgil
            message= _ "Well, here's the money."
	[/message]
                	[gold]
                   	 side=1
                   	 amount=-20
                	[/gold]
        [chat]
            speaker= _ "Money"
            message= _ "Spent 20 gold."
        [/chat]   

        [message]
            speaker=Farrier
            message= _ "With you pleased to deal."
        [/message]
                {VARIABLE power 201}
                {VARIABLE buy 0}
                {VARIABLE powerbow 1}
	[label]
	    x,y=19,4
	    text= _ ""
	    colour=175,0,0
	    visible_in_shroud=yes
	[/label]
                [/then]
            )} 


					# Кузнец - отказ от покупок (200)

	{IF_VAR power equals 200 (
                [then]     

        [message]
            speaker=Farrier
            message= _ "As you know. If you want to come back - during the day I'm always here."
        [/message]
                {VARIABLE buy 1}
                [/then]
            )} 

					# Кузнец - уже куплена вещь (201)

	{IF_VAR power equals 201 (
                [then]     
        [message]
            speaker=Farrier
            message= _ "You've already bought one of the things! To select a different - load savegame before the last purchase!"
        [/message]
                [/then]
            )} 

                [/then]
            )} 


					# Кузнец не торгует



	{IF_VAR farriersale equals 0 (
                [then]    
        [message]
            speaker=Virgil
            message= _ "Hello, smith. I need to buy some useful things in your shop."
	[/message]           
        [message]
            speaker=Farrier
            message= _ "I do not know you. So forget it!"
        [/message]
	[/then]
            )} 



[/event]




					# Эвент найм наемника


[event]
        name=moveto
        first_time_only=no
        [filter]
            x=13,12
	    y=2,1
            id=Virgil
        [/filter]





					# НАЕМНИК ДОСТУПЕН!!!



{IF_VAR nauomnik equals 1 (
[then]               
	{IF_VAR naim equals 0 (
	[then]    
        [message]
            speaker=Naemnik1
            message= _ "What you need?"
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "What you need?"
        [/message]
        [message]
            speaker=Virgil
            message= _ "I need to hire a mercenary. Need help with difficult task."
	[/message]
        [message]
            speaker=Naemnik1
            message= _ "I hope, need to kill someone? I like a fight!"
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "I hope, need to kill someone? I like a fight!"
        [/message]
        [message]
            speaker=Virgil
            message= _ "I think so. How much is your services?"
	[/message]


					# Диалог торга за найм
        [message]
            speaker=Naemnik1
            message= _ "Suggest your price. And maybe we negotiate."
        [option]
		message= _ "20 gold"
            [command]
          	  [set_variable]
          	      name=naem
		      value=120
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "30 gold"
            [command]
          	  [set_variable]
          	      name=naem
		      value=130
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "40 gold"
            [command]
          	  [set_variable]
          	      name=naem
		      value=140
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "50 gold"
            [command]
          	  [set_variable]
          	      name=naem
		      value=150
        	  [/set_variable]
            [/command]
        [/option]
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "Suggest your price. And maybe we negotiate."
        [option]
		message= _ "20 gold"
            [command]
          	  [set_variable]
          	      name=naem
		      value=120
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "30 gold"
            [command]
          	  [set_variable]
          	      name=naem
		      value=130
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "40 gold"
            [command]
          	  [set_variable]
          	      name=naem
		      value=140
        	  [/set_variable]
            [/command]
        [/option]
        [option]
		message= _ "50 gold"
            [command]
          	  [set_variable]
          	      name=naem
		      value=150
        	  [/set_variable]
            [/command]
        [/option]
        [/message]


					# Диалог за 20 золотых (120)


	{IF_VAR naem equals 120 (
                [then]               
        [message]
            speaker=Naemnik1
            message= _ "It is not serious! If so little payment - maybe you could do it by self."
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "It is not serious! If so little payment - maybe you could do it by self."
        [/message]
                {VARIABLE naim 0}
	[/then]
            )} 


					# Диалог за 30 золотых (130)


	{IF_VAR naem equals 130 (
                [then]      
        [message]
            speaker=Naemnik1
            message= _ "Certainly, price is low ... though right."
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "Certainly, price is low ... though right."
        [/message]
                	[gold]
                   	 side=1
                   	 amount=-30
                	[/gold]
        [chat]
            speaker= _ "Money"
            message= _ "Spent 30 gold."
        [/chat]     

        [message]
            speaker=Naemnik1
            message= _ "Anyway ... day after day I do nothing."
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "Anyway ... day after day I do nothing."
        [/message]
	{MODIFY_UNIT id=Naemnik1 side 1}
	{MODIFY_UNIT id=Naemnik2 side 1}
                {VARIABLE badnaemnik 1}
                {VARIABLE naim 1}
	[label]
	    x,y=13,1
	    text= _ ""
	    colour=175,0,0
	    visible_in_shroud=yes
	[/label]
	[/then]
            )} 

					# Диалог за 40 золотых (140)


	{IF_VAR naem equals 140 (
                [then]    
        [message]
            speaker=Naemnik1
            message= _ "It's a deal!"
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "It's a deal!"
        [/message]
                	[gold]
                   	 side=1
                   	 amount=-40
                	[/gold] 
        [chat]
            speaker= _ "Money"
            message= _ "Spent 40 gold."
        [/chat]   
         
        [message]
            speaker=Naemnik1
            message= _ "Well, I'm at your disposal. In four words - Where will we go?"
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "Well, I'm at your disposal. In four words - Where will we go?"
        [/message]
	{MODIFY_UNIT id=Naemnik1 side 1}
	{MODIFY_UNIT id=Naemnik2 side 1}
                {VARIABLE badnaemnik 0}
                {VARIABLE goodnaemnik 0}
                {VARIABLE naim 1}
	[label]
	    x,y=13,1
	    text= _ ""
	    colour=175,0,0
	    visible_in_shroud=yes
	[/label]
	[/then]
            )} 

					# Диалог за 50 золотых (150)


	{IF_VAR naem equals 150 (
                [then]
        [message]
            speaker=Naemnik1
            message= _ "Deal!"
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "Deal!"
        [/message]
                	[gold]
                   	 side=1
                   	 amount=-50
                	[/gold]   
        [chat]
            speaker= _ "Money"
            message= _ "Spent 50 gold."
        [/chat]   
            
        [message]
            speaker=Naemnik1
            message= _ "Excellent! I'm ready to go with you!"
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "Excellent! I'm ready to go with you!"
        [/message]
	{MODIFY_UNIT id=Naemnik1 side 1}
	{MODIFY_UNIT id=Naemnik2 side 1}
                {VARIABLE goodnaemnik 1}
                {VARIABLE naim 1}
	[label]
	    x,y=13,1
	    text= _ ""
	    colour=175,0,0
	    visible_in_shroud=yes
	[/label]
	[/then]
            )} 
[/then]
)} 
[/then]
)} 


					# НАЕМНИК НЕ ДОСТУПЕН!!!

{IF_VAR nauomnik equals 0 (
[then]               
        [message]
            speaker=Naemnik1
            message= _ "What you need?"
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "What you need?"
        [/message]
        [message]
            speaker=Virgil
            message= _ "I need to hire a mercenary. Need help with difficult task."
	[/message]
			[delay]
			    time=400
			[/delay]
        [message]
            speaker=Naemnik1
            message= _ "It seems you already have some companions."
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "It seems you already have some companions."
        [/message]
[/then]
)} 


					# Если НАЕМНИК УЖЕ нанят!!!

{IF_VAR naim equals 1 (
[then]               
        [message]
            speaker=Naemnik1
            message= _ "So we waste time?"
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "So we waste time?"
        [/message]
[/then]
)} 

[/event]



					# Эвент Начало обследования леса


[event]
        name=moveto
        [filter]
            x,y=5,10
            id=Virgil
        [/filter]
	[remove_item]
            x,y=5,10
        [/remove_item]
	[message]
            id=Virgil
            message= _ "It's time to explore the forest and find bandits!"
	[/message]


        [item]
            x,y=1,14
            image=items/gohere.png
        [/item]
        [item]
            x,y=5,14
            image=items/gohere.png
        [/item]
        [item]
            x,y=10,11
            image=items/gohere.png
        [/item]
     		   [scroll_to]
         	   	x=5
       		  	y=14
     		   [/scroll_to]
			[delay]
			    time=400
			[/delay]


{IF_VAR nauomnik equals 0 (
[then]     
	{MOVE_UNIT id=SoldierHelp1 3 11}
	{MOVE_UNIT id=SoldierHelp2 7 10}
[/then]
)} 


{IF_VAR nauomnik equals 1 (
[then]     
	{MOVE_UNIT id=Naemnik1 3 11}
	{MOVE_UNIT id=Naemnik2 3 11}
[/then]
)} 

                [terrain]
                    x=10
                    y=7
                    terrain=Re^Xo
                [/terrain]
                [redraw]
                [/redraw]

        [objectives]
            [objective]
                description= _ "Kill leader of bandits"
                condition=win
            [/objective]
#            [objective]
#                {ALTERNATIVE_OBJECTIVE_CAPTION}
#                description= _ "Kill all bandits"
#                condition=win
#            [/objective]
            [objective]
                description= _ "Death of Virgil"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
		show_turn_counter=yes
            [/objective]
        [/objectives]
[/event]


				# Эвент Ловушки волков в лесу

[event]
        name=moveto
        [filter]
            x,y=1,14
            side=1
        [/filter]

	[message]
            speaker=unit
            message= _ "Here is clean, no one soul!"
	[/message]
	[remove_item]
            x,y=1,14
        [/remove_item]
			[delay]
			    time=400
			[/delay]
	[unit]
            type=Wolf
            id=Wolf1
            side=2
            x=2
            y=12
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            {IS_LOYAL}
        [/unit]
	[unit]
            type=Wolf
            id=Wolf2
            side=2
            x=3
            y=14
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            {IS_LOYAL}
        [/unit]
	[message]
            speaker=unit
            message= _ "Oops, wolves here!"
	[/message]

		[music]
   			name=data/add-ons/Way_of_Dragon/music/solo_fight_theme.ogg
		[/music]
	 
[/event]

									# Music changes wolfs dead
[event]
        name=die
        [filter]
            id=Wolf1
            id=Wolf2
        [/filter]

		[music]
   			name=data/add-ons/Way_of_Dragon/music/CityTheme.ogg
		[/music]
[/event]

[event]
        name=moveto
        [filter]
            x,y=10,11
            side=1
        [/filter]
	[message]
            speaker=unit
            message= _ "There is clean!"
	[/message]
	[remove_item]
            x,y=10,11
        [/remove_item]
			[delay]
			    time=400
			[/delay]
	[unit]
            type=Great Wolf
            id=WolfBig
            side=2
            x=8
            y=12
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            {IS_LOYAL}
        [/unit]
	[message]
            speaker=unit
            message= _ "Wow, wolf! Watch out!"
	[/message]

		[music]
   			name=data/add-ons/Way_of_Dragon/music/solo_fight_theme.ogg
		[/music]
	 
[/event]
									# Music changes wolfs dead
[event]
        name=die
        [filter]
            id=WolfBig
        [/filter]

		[music]
   			name=data/add-ons/Way_of_Dragon/music/CityTheme.ogg
		[/music]
[/event]


				# Эвент Бандитский лагерь

[event]
        name=moveto
        [filter]
            x,y=5,14
            side=1
        [/filter]
	[remove_item]
            x,y=5,14
        [/remove_item]


                [terrain]
                    x=3
                    y=16
                    terrain=Ww^Bw/
                [/terrain]
                [terrain]
                    x=3
                    y=17
                    terrain=Wog^Bw|
                [/terrain]
                [terrain]
                    x=4
                    y=17
                    terrain=Wog^Bw\
                [/terrain]
                [terrain]
                    x=5
                    y=18
                    terrain=Wog^Bw/
                [/terrain]
                [terrain]
                    x=6
                    y=17
                    terrain=Ww^Bw|
                [/terrain]
                [terrain]
                    x=5
                    y=16
                    terrain=Ke
                [/terrain]
                [terrain]
                    x=5
                    y=15
                    terrain=Gg^Fi
                [/terrain]

                [redraw]
                [/redraw]
	[message]
            speaker=unit
            message= _ "Bandits are here! Attack them!"
	[/message]

#			{FULL_HEAL id=Virgil}
			{FULL_HEAL id=Naemnik1}
			{FULL_HEAL id=Naemnik2}
			{FULL_HEAL id=SoldierHelp1}
			{FULL_HEAL id=SoldierHelp2}

	[unit]
            type=Footpad
            id=Bandit01
            side=2
            x=3
            y=14
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Thug
            id=Bandit02
            side=2
            x=7
            y=14
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]

	[unit]
            type=Poacher
            id=Bandit04
            side=2
            x=3
            y=16
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Ruffian
            name= _ "Kryun"
            unrenamable=yes
            id=MainBandit
            side=2
            x=5
            y=16
	    overlays="data/add-ons/Way_of_dragon/images/icons/crown.png"
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[message]
            id=MainBandit
            message= _ "We have guests! To arms!"
	[/message]

                {VARIABLE koster 1}


{IF_VAR dopbandits equals 0 (
[then] 
	[message]
            id=MainBandit
            message= _ "Kill him! This is the man who killed our friends near the bridge!"
	[/message]    
[/then]
)} 


{IF_VAR dopbandits equals 1 (
[then]     
	[unit]
            type=Thug
            id=Bandit05
            side=2
            x=3
            y=16
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
	[unit]
            type=Thief
            id=Bandit03
            side=2
            x=6
            y=16
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]

	[message]
            id=Bandit03
            message= _ "Look! This is the coward, who was recently robbed near the bridge!"
	[/message]   
[/then]
)} 

		[music]
   			name=data/add-ons/Way_of_Dragon/music/solo_fight_theme.ogg
		[/music]
	 
[/event]

											# Event Fire damage
#[event]
#        name=moveto
#        first_time_only=no
#        [filter]
#		x=5
#		y=15
#        [/filter]
#{IF_VAR koster equals 1 (
#[then] 
#		[modify_unit]
#		  hitpoints=-5
#		[/modify_unit]
#[/then]
#)} 
#[/event]



[event]
        name=die
        [filter]
            id=MainBandit
        [/filter]
        [message]
            id=MainBandit
            message= _ "Ooouuummm..."
        [/message]
        [message]
            speaker=narrator
            message= _ "Bandit leader was killed!"
            image=wesnoth-icon.png
	[/message]

                [terrain]
                    x=10
                    y=7
                    terrain=Re
                [/terrain]
                [redraw]
                [/redraw]
	[modify_turns]
		add=5
	[/modify_turns]

        [objectives]
            [objective]
                description= _ "Report that the leader of bandits is dead"
                condition=win
            [/objective]
            [objective]
                {ALTERNATIVE_OBJECTIVE_CAPTION}
                description= _ "Kill all bandits"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Virgil"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
		show_turn_counter=yes
            [/objective]
        [/objectives]

        {HIGHLIGHT_IMAGE 5 3 items/gohere.png ()}

     		   [scroll_to]
         	   	x=1
       		  	y=1
     		   [/scroll_to]
			[delay]
			    time=600
			[/delay]


                {VARIABLE endmission 1}
[/event]

									# Music changes wolfs dead
[event]
        name=die
        [filter]
            id=MainBandit
            id=Bandit01
            id=Bandit02
            id=Bandit03
            id=Bandit04
            id=Bandit05
        [/filter]

		[music]
   			name=data/add-ons/Way_of_Dragon/music/CityTheme.ogg
		[/music]
[/event]

					# антизахват деревень
[event]
        name=moveto
      first_time_only=no
        [filter]
            		x=1,1,2,2,3,4,3,4,5,6,7,8,9,10,9,10,11,11,12,19
	   		y=5,6,5,6,6,6,7,4,5,5,2,2,3,3,1,1,1,2,2,4
	    side=1
        [/filter]
        [message]
            speaker=narrator
            message= _ "Do you want that you have not considered the city thief? Then do not enter in others houses!"
            image=wesnoth-icon.png
	[/message]
		[capture_village]
            		x=1,1,2,2,3,4,3,4,5,6,7,8,9,10,9,10,11,11,12
	   		y=5,6,5,6,6,6,7,4,5,5,2,2,3,3,1,1,1,2,2
			side=3
		[/capture_village]
		[capture_village]
            		x=19
	   		y=4
			side=4
		[/capture_village]	

[/event]


					# Эвент Сдача задания
[event]
        name=moveto
        [filter]
            x,y=5,3
            id=Virgil
        [/filter]
{IF_VAR endmission equals 1 (
[then]               

		[music]
   			name=data/add-ons/Way_of_Dragon/music/CityTheme.ogg
		[/music]

        [message]
            speaker=Virgil
            message= _ "I found camp of bandits found. Now bandit leader is dead."
	[/message]
        [message]
            id=Truman
            message= _ "Really? And where was a camp?"
        [/message]
        [message]
            speaker=Virgil
            message= _ "Right near the Great river. It looks like they are there for a long time, because there is even a small port! Maybe, they will back."
	[/message]
        [message]
            id=Truman
            message= _ "You have gave to the city invaluable service, citizen! head of the city guards want to personally see you! Also thanks from me - a small cash prize!"
        [/message]      
          	[gold]
                   	 side=1
                   	 amount=100
                [/gold]
        [chat]
            speaker= _ "Money"
            message= _ "Received 100 gold."
        [/chat]   

	[remove_item]
            x,y=5,3
        [/remove_item]

                [terrain]
                    x=2
                    y=1
                    terrain=Rrc
                [/terrain]
                [redraw]
                [/redraw]

	[label]
	    x,y=1,1
	    text= _ ""
	    colour=175,0,0
	    visible_in_shroud=yes
	[/label]


        [objectives]
            [objective]
                description= _ "Report about danger in cavern to head of the city guards"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Virgil"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
		show_turn_counter=yes
            [/objective]
        [/objectives]

        {HIGHLIGHT_IMAGE 2 1 data/add-ons/Way_of_Dragon/images/items/exit.png ()}

		[modify_unit]
			[filter]
				id=Virgil
			[/filter]
  			moves=5
		[/modify_unit]
	{MODIFY_UNIT id=Freeman side 3}
	{MODIFY_UNIT id=GuardCity3 side 3}
[/then]
)} 
[/event]




	# Эвент победы

[event]
        name=moveto
        [filter]
            x,y=2,1
            id=Virgil
        [/filter]
	[remove_item]
            x,y=2,1
        [/remove_item]
	[message]
        	speaker=SoldierHelp1
		message= _ "Mission accomplished, sir!"
	[/message]
	[message]
        	speaker=SoldierHelp2
		message= _ "Good luck to you, sir!"
	[/message]
	{MODIFY_UNIT id=SoldierHelp1 side 3}
	{MODIFY_UNIT id=SoldierHelp2 side 3}

	{MOVE_UNIT id=SoldierHelp1 4 3}
	{MOVE_UNIT id=SoldierHelp2 6 2}


	{IF_VAR goodnaemnik equals 0 (
                [then]  
	{MODIFY_UNIT id=Naemnik1 side 4}
	{MODIFY_UNIT id=Naemnik2 side 4}
        [message]
            speaker=Naemnik1
            message= _ "That's all! It was nice to work for you!"
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "That's all! It was nice to work for you!"
        [/message]
	[/then]
            )} 
	{IF_VAR goodnaemnik equals 1 (
                [then]  
        [message]
            speaker=Naemnik1
            message= _ "I enjoyed working with you! I would like to travel with you further!"
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "I enjoyed working with you! I would like to travel with you further!"
        [/message]
	[/then]
            )} 
	{IF_VAR badnaemnik equals 1 (
                [then]  
        [message]
            speaker=Naemnik1
            message= _ "I think that you underpaid me for this job. I think we'll meet again later!"
        [/message]
        [message]
            speaker=Naemnik2
            message= _ "I think that you underpaid me for this job. I think we'll meet again later!"
        [/message]
	{MODIFY_UNIT id=Naemnik1 side 4}
	{MODIFY_UNIT id=Naemnik2 side 4}
                {VARIABLE badnaemniknexttime 1}
	[/then]
            )}

			[delay]
			    time=1000
			[/delay]


        [message]
            speaker=Freeman
            message= _ "I greet you, Virgil. You had an invaluable service to the city!"
	[/message]
        [message]
            speaker=Virgil
            message= _ "Yet bandits - only a small part of the trouble. The city is in much greater danger!"
	[/message]
        [message]
            speaker=narrator
            message= _ "Virgil told to head of the city guards about what danger hangs over the city..."
            image=wesnoth-icon.png
        [/message]
        [endlevel]
            result=victory
        [/endlevel]
[/event]


	

	# Эвенты поражений

[event]
        name=die
        [filter]
            id=Virgil
        [/filter]
        [message]
            id=Virgil
            message= _ "Oooouuuu..."
        [/message]
        [message]
            speaker=narrator
            message= _ "The main hero was killed!"
            image=wesnoth-icon.png
	[/message]
        [endlevel]
            result=defeat
        [/endlevel]
[/event]
[event]
        name=die
        [filter]
            id=Jeffry
        [/filter]
        [message]
            id=Jeffry
            message= _ "Uuuummmfff..."
        [/message]
        [message]
            speaker=narrator
            message= _ "The key hero was killed!"
            image=wesnoth-icon.png
	[/message]
        [endlevel]
            result=defeat
        [/endlevel]
[/event]
[event]
        name=time over
        [message]
            speaker=narrator
            message= _ "You did not had to inform about danger, and soon the city was attacked by undead. The siege lasted not long, and soon in the city there is not a living soul ..."
            image=items/bones.png
        [/message]
        [message]
            speaker=narrator
            message= _ "Turns run out!"
            image=wesnoth-icon.png
	[/message]
        [endlevel]
            result=defeat
        [/endlevel]
[/event]

[/scenario]
